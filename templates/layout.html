<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>{% block title %}Oeste Digital{% endblock %}</title> {# Título dinámico para cada página #}
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet" xintegrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    {# Font Awesome para los iconos de dashboard #}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" xintegrity="sha512-..." crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
  </head>
  <body class="{{ user_role_class }} d-flex flex-column min-vh-100">
    <nav class="navbar navbar-expand-lg navbar-dark">
      <div class="container-fluid">
        <a class="navbar-brand" href="{{ url_for('home') }}"> Oeste Cursos </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link {% if request.endpoint == 'home' %}active{% endif %}" aria-current="page" href="{{ url_for('home') }}">Inicio</a>
            </li>
            <li class="nav-item">
              <a class="nav-link {% if request.endpoint == 'about' %}active{% endif %}" href="{{ url_for('about') }}">Nosotros</a>
            </li>
            <li class="nav-item">
              <a class="nav-link {% if request.endpoint == 'cursos' %}active{% endif %}" href="{{ url_for('cursos') }}">Cursos</a>
            </li>
            <li class="nav-item">
              <a class="nav-link {% if request.endpoint == 'galeria' %}active{% endif %}" href="{{ url_for('galeria') }}">Galeria</a>
            </li>    
            <li class="nav-item">
              <a class="nav-link {% if request.endpoint == 'contacts' %}active{% endif %}" href="{{ url_for('contacts') }}">Contacto</a>
            </li>    
            
            {# Lógica condicional para la navegación de usuario #}
            {% if 'user' in session %} {# Si el usuario está logueado #}
              <li class="nav-item">
                <a class="nav-link {% if request.endpoint == 'dashboard' %}active{% endif %}" href="{{ url_for('dashboard') }}">Dashboard</a>
              </li>
              
              <li class="nav-item">
                <a class="nav-link" href="{{ url_for('logout') }}">Cerrar Sesión</a>
              </li>
            {% else %} {# Si el usuario NO está logueado #}
              <li class="nav-item">
                <a class="nav-link {% if request.endpoint == 'login' %}active{% endif %}" href="{{ url_for('login') }}">Iniciar Sesión</a>
              </li>
            {% endif %}
          </ul>
        </div>
      </div>
    </nav>

    <div class="container p-4 flex-grow-1">
      {# Bloque para mostrar mensajes flash #}
      {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
              <div class="mt-3"> {# Añade un margen superior para que no se pegue al navbar #}
                  {% for category, message in messages %}
                      <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                          {{ message }}
                          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                      </div>
                  {% endfor %}
              </div>
          {% endif %}
      {% endwith %}

      {# Contenido específico de cada página #}
      {% block content %}
      {% endblock %}
    </div>

    <footer class="footer py-3 mt-auto">
      <div class="container">
        <div class="row align-items-center">
          <div class="col-md-6 text-md-start text-center">
            <p class="mb-0">Contáctanos: <a href="mailto:info@oestecursos.com">info@oestecursos.com</a></p>
          </div>
          <div class="col-md-6 text-md-end text-center">
            <a href="https://facebook.com" target="_blank" class="text-white me-3">
              <i class="bi bi-facebook"></i>
            </a>
            <a href="https://instagram.com" target="_blank" class="text-white me-3">
              <i class="bi bi-instagram"></i>
            </a>
            <a href="https://x.com" target="_blank" class="text-white">
              <i class="bi bi-twitter-x"></i>
            </a>
          </div>
        </div>
      </div>
    </footer>

    <button class="btn btn-primary btn-volver-arriba" id="btnVolverArriba" style="display: none;">
      <i class="bi bi-arrow-up"></i>
    </button>
    
    {# Los scripts se cargan al final del body para mejor rendimiento #}
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js" xintegrity="sha384-u1OknCvxWvY5kfmNBILK2hRnQC3Pr17a+RTT6rIHI7NnikvbZlHgTPOOmMi466C8" crossorigin="anonymous"></script>
    
    {# --- INICIO DE LA SECCIÓN DE FIREBASE JS SDK --- #}
    {# Carga las librerías de Firebase JS SDK #}
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script>
      // Tu configuración de Firebase para el cliente
      // Asegúrate de que esta configuración coincida con la de tu index3.py
      const firebaseConfig = {
        apiKey: "AIzaSyC9235MKChIqW08kyANQ2xVTWE-GGQyFlo",
        authDomain: "oeste-cursos.firebaseapp.com",
        databaseURL: "https://oeste-cursos-default-rtdb.firebaseio.com",
        projectId: "oeste-cursos",
        storageBucket: "oeste-cursos.firebasestorage.app",
        messagingSenderId: "700940543669",
        appId: "1:700940543669:web:a6279f64f40f0c05814144",
        measurementId: "G-N48L09C2T1"
      };
      // Inicializa Firebase
      firebase.initializeApp(firebaseConfig);
    </script>
    {# --- FIN DE LA SECCIÓN DE FIREBASE JS SDK --- #}

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    
    {# Bloque para scripts adicionales específicos de cada página #}
    {% block extra_scripts %}
    {% endblock %}
  </body>
</html>
